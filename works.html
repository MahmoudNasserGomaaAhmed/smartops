<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Portfolio</title>
<style>
* { box-sizing:border-box; margin:0; padding:0; }
body { font-family: Arial,sans-serif; background:#f5f6fa; color:#333; line-height:1.6; padding:20px; }
.portfolio-header { display:flex; justify-content:space-between; align-items:center; padding:20px; background:#443e63; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); margin-bottom:30px; }
.portfolio-header h1 { font-size:28px; color:#fff; }
.portfolio-header button { padding:8px 16px; border:none; border-radius:6px; cursor:pointer; margin-left:5px; transition:0.3s; color:#fff; }
#adminBtn { background:#2f2e75; } #adminBtn:hover { background:#553fb9; }
#langToggle { background:#2196F3; } #langToggle:hover { background:#1976D2; }

#portfolioWrapper {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
  gap: 25px;
}

.project-card {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.1);
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  text-align: left;
}
.project-card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.15); }
.project-card img { width: 100%; height: 300px; object-fit: cover; display: block; border-bottom: 1px solid #ddd; }
.project-card span { display: inline-block; font-size: 13px; background: #e5f9f6; color: #0a2540; padding: 5px 10px; border-radius: 20px; margin: 10px 15px 5px 15px; }
.project-card h4 { margin: 5px 15px; font-size: 18px; color: #0a2540; }
.project-card p { margin: 0 15px 15px 15px; font-size: 14px; color: #555; }

/* Modal */
.modal { display:none; position:fixed; inset:0; background: rgba(0,0,0,.6); justify-content:center; align-items:center; z-index:1000; }
.modal-content { background:#fff; padding:20px; width:320px; border-radius:10px; display:flex; flex-direction:column; gap:10px; }
.modal-content input { padding:8px; width:80%; }
.modal-content button { padding:10px; cursor:pointer; color:#fff; border:none; border-radius:6px; transition:0.3s; }
#saveProjectBtn { background:#22185a; } #saveProjectBtn:hover { background:#45a049; }
#cancelBtn { background:#f44336; } #cancelBtn:hover { background:#e53935; }

@media(max-width:768px){ #portfolioWrapper{grid-template-columns:repeat(auto-fill,minmax(220px,1fr));} .project-card img{height:150px;} }
</style>
</head>
<body>

<div class="portfolio-header">
  <h1 data-en="Our Projects" data-ar="أعمالنا"></h1>
  <div>
    <button id="adminBtn">Add Project</button>
    <button id="langToggle">AR</button>
  </div>
</div>

<div id="portfolioWrapper"></div>

<!-- Modal -->
<div id="adminModal" class="modal">
  <div class="modal-content">
    <input id="catEn" placeholder="Category EN">
    <input id="catAr" placeholder="Category AR">
    <input id="titleEn" placeholder="Title EN">
    <input id="titleAr" placeholder="Title AR">
    <input id="descEn" placeholder="Description EN">
    <input id="descAr" placeholder="Description AR">
    <input id="mediaUrl" placeholder="Media URL">
    <button id="saveProjectBtn">Save Project</button>
    <button id="cancelBtn">Cancel</button>
  </div>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCxfpdlFq4EcTc6VfAM26V6Z3ACVuRdank",
  authDomain: "smartops-d24c5.firebaseapp.com",
  databaseURL: "https://smartops-d24c5-default-rtdb.firebaseio.com",
  projectId: "smartops-d24c5",
  storageBucket: "smartops-d24c5.firebasestorage.app",
  messagingSenderId: "923876929462",
  appId: "1:923876929462:web:6039881f65607766c91b17"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

document.addEventListener("DOMContentLoaded", () => {
  const wrapper = document.getElementById("portfolioWrapper");
  const adminBtn = document.getElementById("adminBtn");
  const modal = document.getElementById("adminModal");
  const saveBtn = document.getElementById("saveProjectBtn");
  const cancelBtn = document.getElementById("cancelBtn");

  const catEnInput = document.getElementById("catEn");
  const catArInput = document.getElementById("catAr");
  const titleEnInput = document.getElementById("titleEn");
  const titleArInput = document.getElementById("titleAr");
  const descEnInput = document.getElementById("descEn");
  const descArInput = document.getElementById("descAr");
  const mediaUrlInput = document.getElementById("mediaUrl");

  const projectsRef = ref(db, 'projects');

  // عرض المشاريع من Firebase
function renderFromFirebase() {
  onValue(projectsRef, (snapshot) => {
    wrapper.innerHTML = "";
    snapshot.forEach(childSnapshot => {
      const key = childSnapshot.key; // مهم لحذف المشروع
      const p = childSnapshot.val();
      const card = document.createElement("div");
      card.className = "project-card";
      card.innerHTML = `
        <img src="${p.media}" alt="${p.titleEn}">
        <span data-en="${p.catEn}" data-ar="${p.catAr}">${p.catEn}</span>
        <h4 data-en="${p.titleEn}" data-ar="${p.titleAr}">${p.titleEn}</h4>
        <p data-en="${p.descEn}" data-ar="${p.descAr}">${p.descEn}</p>
        <button class="deleteBtn" style="margin:10px;background:#f44336;color:white;padding:5px;border:none;border-radius:5px;">Delete</button>
      `;
      wrapper.appendChild(card);

      // زر الحذف
      card.querySelector(".deleteBtn").addEventListener("click", () => {
        import("https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js")
          .then(({ remove, ref }) => {
            remove(ref(db, 'projects/' + key))
              .then(() => console.log("Project deleted"))
              .catch(err => console.error(err));
          });
      });
    });
    switchLang();
  });
}


  renderFromFirebase();

  // Modal events
  adminBtn.addEventListener("click", ()=> modal.style.display="flex");
  cancelBtn.addEventListener("click", ()=> modal.style.display="none");

  saveBtn.addEventListener("click", () => {
    const newProject = {
      catEn: catEnInput.value || "Category",
      catAr: catArInput.value || "فئة",
      titleEn: titleEnInput.value,
      titleAr: titleArInput.value || "عنوان",
      descEn: descEnInput.value || "",
      descAr: descArInput.value || "",
      media: mediaUrlInput.value
    };
    push(projectsRef, newProject)
      .then(() => {
        modal.style.display = "none";
        catEnInput.value = "";
        catArInput.value = "";
        titleEnInput.value = "";
        titleArInput.value = "";
        descEnInput.value = "";
        descArInput.value = "";
        mediaUrlInput.value = "";
      })
      .catch(err => console.error(err));
  });

  // Language toggle
  let isEnglish = true;
  const toggle = document.getElementById("langToggle");
  function switchLang(){
    document.querySelectorAll("[data-en]").forEach(el=>{
      el.textContent = isEnglish ? el.dataset.en : el.dataset.ar;
    });
    document.documentElement.lang = isEnglish ? "en" : "ar";
    document.body.style.direction = isEnglish ? "ltr" : "rtl";
    if(toggle) toggle.textContent = isEnglish ? "AR" : "EN";
  }
  if(toggle) toggle.addEventListener("click", ()=>{ isEnglish=!isEnglish; switchLang(); });

});





</script>

</body>
</html>
